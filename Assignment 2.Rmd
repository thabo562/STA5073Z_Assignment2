---
title: "Assignment 1"
author: "Natalie Alexander, Thabo Dube & Kelly-Robyn Singh"
date: "2023-10-06"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(stringr)
library(dplyr)
library(tidyverse)
library(ggplot2)
install.packages("textdata")
library(textdata)
install.packages("tidytext")
library(tidytext)

#update r and install git
install.packages("remotes")
remotes::install_github(sprintf("rstudio/%s",
                        c("reticulate", "tensorflow", "keras")))
keras:: install_keras()
library(keras)
library(tensorflow)
tf$constant("Hello world")
```

```{r}
#update r and install git
install.packages("remotes")
remotes::install_github(sprintf("rstudio/%s",
                        c("reticulate", "tensorflow", "keras")))
keras:: install_keras()
library(keras)
library(tensorflow)
tf$constant("Hello world")
```


```{r Reading in Data}
set.seed(2022)
load("F:/STA5073Z- DS4I/pre-processed assignment data.RData") # you can change to where you have it saved
sona<-sona%>% mutate(speech= str_replace(speech, "\\d{1,2} [A-Za-z]+ \\d{4}", "")) # Remove dates at the start of the speech
sona<- sona%>% mutate(speech= str_replace(speech, pattern = "^Thursday, ", replacement = ""))# remove dates on 2 remaining Ramaphosa speeches 
sona<- sona%>% mutate(speech= str_trim(speech, side= "left"))

Sona_S_tokenized<- unnest_tokens(sona, sentence, speech, token = 'sentences') 
Sona_S_tokenized<- Sona_S_tokenized%>% mutate(sentence= str_replace_all(sentence, "[[:punct:]]", ""))

```

```{r Data analyisis}
afinn <- get_sentiments('afinn') # Lexicon of sentiments with value attached ranging from -5 to 5 

speech_data_tidy <- sona %>%
  unnest_tokens(word, speech, token = "words")
speech_data_tidy<- speech_data_tidy%>% mutate(word= str_replace_all(word, "[[:punct:]]", ""))

speech_data_sentiment <- speech_data_tidy %>%
  inner_join(get_sentiments("afinn")) %>%
  group_by(president_13)


speech_data_sentiment%>% filter(president_13=="Mandela")%>%
                        ggplot( aes(x = value)) +
  geom_histogram(binwidth = 1, fill = "blue") +
  labs(x = "Sentiment Value", y = "Count") +
  ggtitle("Count of Words by Sentiment Value")




```

